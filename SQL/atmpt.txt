SELECT
    td.orgName, td.staName, td.ReportDate, td.capacity, td.sum_oe, td.sum_sd, pe.amount, td.month, pe.month
FROM
    (
        SELECT
            ts.orgName,
            ts.staName,
            ts.capacity,
            ts.station_id,
            sum(ts.ongrid_energy) sum_oe,
            sum(ts.sunshineDuration) sum_sd,
            ts.ReportDate,
            ts.year,
            ts.month
        FROM
            (
                SELECT
                    org.name orgName,
                    sta.name staName,
                    sta.capacity,
                    pd.station_id,
                    pd.ongrid_energy,
                    pd.obliquee_exposure/3.6 sunshineDuration,
                    DATE_FORMAT(pd.report_date, '%Y-%m') AS ReportDate,
                    YEAR(pd.report_date) AS year,
                    MONTH(pd.report_date) AS month
                FROM
                    pms_dailyproductionreports pd
                LEFT JOIN stations sta ON sta.id = pd.station_id
                LEFT JOIN organizations org ON sta.organization_id = org.id
                WHERE pd.status = 1
                AND pd.ori_id = 0
                AND sta.status = 1
                AND org.status = 1
                AND org.id = 1
                AND sta.id = 3
                AND pd.report_date > '2018-01-01'
                AND pd.report_date < '2018-06-30'
            ) ts
        GROUP BY
            ts.ReportDate DESC,
            ts.station_id,
            ts.year,
            ts.month
    ) td
LEFT JOIN pms_energyplannings pe
ON pe.station_id = td.station_id
AND pe.year = td.year
AND pe.month = td.month
AND pe.status = 1
AND pe.type = '上网电量'



SELECT
	team.id,
	team.teamName,
	member.nickname,
	leader.nickname 
FROM
	team
	LEFT JOIN `user` AS member ON member.userId = team.members
	LEFT JOIN `user` AS leader ON leader.userId = team.leaderId 
WHERE
	team.id =1

可以多次关联同一张表